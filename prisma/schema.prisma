generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Brand {
  id              String           @id @default(cuid())
  name            String           @unique
  description     String?
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  images          String[]
  createdBy       String?
  updateNotes     String?
  updatedBy       String?
  colorbase       String?          @default("#03438f")
  link_sampul     String?
  kategoriProduks KategoriProduk[]
  produks         Produk[]

  @@map("brands")
}

model KategoriProduk {
  id                 String              @id @default(cuid())
  name               String
  description        String?
  brandId            String
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
  images             String[]
  createdBy          String?
  updateNotes        String?
  updatedBy          String?
  brand              Brand               @relation(fields: [brandId], references: [id], onDelete: Cascade)
  produks            Produk[]            @relation("KategoriProdukToProduk")
  subkategoriProduks SubkategoriProduk[]

  @@map("kategori_produks")
}

model SubkategoriProduk {
  id               String         @id @default(cuid())
  name             String
  description      String?
  kategoriProdukId String
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
  images           String[]
  createdBy        String?
  updateNotes      String?
  updatedBy        String?
  produks          Produk[]
  kategoriProduk   KategoriProduk @relation(fields: [kategoriProdukId], references: [id], onDelete: Cascade)

  @@map("subkategori_produks")
}

model Produk {
  id                  String             @id @default(cuid())
  name                String
  description         String?
  subkategoriProdukId String?
  createdAt           DateTime           @default(now())
  updatedAt           DateTime           @updatedAt
  images              String[]
  createdBy           String?
  updateNotes         String?
  updatedBy           String?
  status              ProductStatus      @default(ACTIVE)
  kapasitas           String?
  harga               Decimal?           @db.Decimal(12, 2)
  categoryId          String?
  brandId             String?
  detailProduks       DetailProduk[]
  brand               Brand?             @relation(fields: [brandId], references: [id])
  kategoriProduk      KategoriProduk?    @relation("KategoriProdukToProduk", fields: [categoryId], references: [id], onDelete: Cascade)
  subkategoriProduk   SubkategoriProduk? @relation(fields: [subkategoriProdukId], references: [id], onDelete: Cascade)

  @@map("produks")
}

model DetailProduk {
  id        String   @id @default(cuid())
  name      String
  produkId  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  images    String[]
  detail    String
  produk    Produk   @relation(fields: [produkId], references: [id], onDelete: Cascade)

  @@map("detail_produks")
}

model KategoriSOP {
  id          String   @id @default(cuid())
  name        String   @unique
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  sops        SOP[]

  @@map("kategori_sops")
}

model SOP {
  id            String      @id @default(cuid())
  name          String
  description   String?
  kategoriSOPId String
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  link          String?
  jenisSOPs     JenisSOP[]
  kategoriSOP   KategoriSOP @relation(fields: [kategoriSOPId], references: [id], onDelete: Cascade)

  @@map("sops")
}

model JenisSOP {
  id          String      @id @default(cuid())
  name        String
  content     String?
  sopId       String
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  images      String[]
  createdBy   String?
  updateNotes String?
  updatedBy   String?
  link        String?
  detailSOPs  DetailSOP[]
  sop         SOP         @relation(fields: [sopId], references: [id], onDelete: Cascade)

  @@map("jenis_sops")
}

model DetailSOP {
  id         String   @id @default(cuid())
  name       String
  value      String
  jenisSOPId String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  jenisSOP   JenisSOP @relation(fields: [jenisSOPId], references: [id], onDelete: Cascade)

  @@map("detail_sops")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String
  role      UserRole @default(SUPER_ADMIN)
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}

model Agent {
  id           String        @id
  name         String
  email        String        @unique
  password     String
  category     String        @default("socialMedia")
  isActive     Boolean       @default(true)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  foto         String?
  performances Performance[]

  @@index([name])
  @@index([email])
  @@index([category])
  @@index([isActive])
  @@index([createdAt])
  @@map("agents")
}

model Performance {
  id              String   @id @default(cuid())
  agentId         String   @map("agent_id")
  qaScore         Int      @default(0) @map("qa_score")
  quizScore       Int      @default(0) @map("quiz_score")
  typingTestScore Int      @default(0) @map("typing_test_score")
  timestamp       DateTime @default(now())
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  afrt            Int      @default(0)
  art             Int      @default(0)
  csat            Int      @default(0)
  rr              Int      @default(0)
  rt              Int      @default(0)
  agent           Agent    @relation(fields: [agentId], references: [id], onDelete: Cascade)

  @@index([agentId])
  @@index([timestamp])
  @@index([agentId, timestamp])
  @@map("performances")
}

model Knowledge {
  id               String            @id @default(cuid())
  title            String
  description      String?
  createdAt        DateTime          @default(now())
  updatedAt        DateTime          @updatedAt
  createdBy        String?
  updatedBy        String?
  logos            String[]
  updateNotes      String?
  detailKnowledges DetailKnowledge[]

  @@index([title])
  @@index([createdAt])
  @@map("knowledges")
}

model DetailKnowledge {
  id                    String                 @id @default(cuid())
  name                  String
  knowledgeId           String
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt
  description           String?
  logos                 String[]
  knowledge             Knowledge              @relation(fields: [knowledgeId], references: [id], onDelete: Cascade)
  jenisDetailKnowledges JenisDetailKnowledge[]

  @@map("detail_knowledges")
}

model JenisDetailKnowledge {
  id                          String                       @id @default(cuid())
  name                        String
  description                 String?
  logos                       String[]
  detailKnowledgeId           String
  createdAt                   DateTime                     @default(now())
  updatedAt                   DateTime                     @updatedAt
  detailKnowledge             DetailKnowledge              @relation(fields: [detailKnowledgeId], references: [id], onDelete: Cascade)
  produkJenisDetailKnowledges ProdukJenisDetailKnowledge[]

  @@map("jenis_detail_knowledges")
}

model ProdukJenisDetailKnowledge {
  id                     String               @id @default(cuid())
  name                   String
  description            String?
  logos                  String[]
  jenisDetailKnowledgeId String
  createdAt              DateTime             @default(now())
  updatedAt              DateTime             @updatedAt
  jenisDetailKnowledge   JenisDetailKnowledge @relation(fields: [jenisDetailKnowledgeId], references: [id], onDelete: Cascade)

  @@map("produk_jenis_detail_knowledges")
}

model QualityTraining {
  id                    String                 @id @default(cuid())
  title                 String
  description           String?
  logos                 String[]
  createdBy             String?
  updatedBy             String?
  updateNotes           String?
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt
  jenisQualityTrainings JenisQualityTraining[]

  @@index([title])
  @@index([createdAt])
  @@map("quality_trainings")
}

model JenisQualityTraining {
  id                     String                  @id @default(cuid())
  name                   String
  description            String?
  logos                  String[]
  qualityTrainingId      String
  createdAt              DateTime                @default(now())
  updatedAt              DateTime                @updatedAt
  updateNotes            String?
  updatedBy              String?
  detailQualityTrainings DetailQualityTraining[]
  qualityTraining        QualityTraining         @relation(fields: [qualityTrainingId], references: [id], onDelete: Cascade)

  @@map("jenis_quality_trainings")
}

model DetailQualityTraining {
  id                        String                     @id @default(cuid())
  name                      String
  description               String?
  logos                     String[]
  jenisQualityTrainingId    String
  createdAt                 DateTime                   @default(now())
  updatedAt                 DateTime                   @updatedAt
  linkslide                 String?
  updateNotes               String?
  updatedBy                 String?
  jenisQualityTraining      JenisQualityTraining       @relation(fields: [jenisQualityTrainingId], references: [id], onDelete: Cascade)
  subdetailQualityTrainings SubdetailQualityTraining[]

  @@map("detail_quality_trainings")
}

model SubdetailQualityTraining {
  id                      String                @id @default(cuid())
  name                    String
  description             String?
  logos                   String[]
  detailQualityTrainingId String
  createdAt               DateTime              @default(now())
  updatedAt               DateTime              @updatedAt
  updateNotes             String?
  updatedBy               String?
  detailQualityTraining   DetailQualityTraining @relation(fields: [detailQualityTrainingId], references: [id], onDelete: Cascade)

  @@map("subdetail_quality_trainings")
}

model TracerUpdate {
  id                String   @id @default(cuid())
  actionType        String   @map("action_type")
  changedAt         DateTime @default(now()) @map("changed_at")
  changedBy         String?  @map("changed_by")
  fieldName         String   @map("field_name")
  newValue          String?  @map("new_value")
  oldValue          String?  @map("old_value")
  sourceKey         String   @map("source_key")
  sourceTable       String   @map("source_table")
  brandId           String?  @map("brand_id")
  categoryId        String?  @map("category_id")
  knowledgeId       String?  @map("knowledge_id")
  qualityTrainingId String?  @map("quality_training_id")
  sopId             String?  @map("sop_id")
  subcategoryId     String?  @map("subcategory_id")

  @@index([sourceTable])
  @@index([sourceKey])
  @@index([actionType])
  @@index([changedAt])
  @@index([brandId])
  @@index([categoryId])
  @@index([subcategoryId])
  @@index([knowledgeId])
  @@index([sopId])
  @@index([qualityTrainingId])
  @@map("tracer_updates")
}

enum ProductStatus {
  NEW
  REVAMP
  DISCONTINUE
  ACTIVE
}

enum UserRole {
  SUPER_ADMIN
  ADMIN
  AGENT
}
